# content_fetcher.py 요약

## 역할
- 게시물 상세 페이지를 요청해 본문 텍스트, 이미지 URL, 댓글 정보를 추출한다.
- 이미지를 다운로드해 로컬 파일로 저장하고, DB에 삽입할 메타데이터를 생성한다.
- HTTP 응답의 `Content-Type` 또는 파일 내용을 분석해 적절한 확장자를 추론한다.

## 핵심 구성 요소
- **`fetch_post_body`**: 요청 헤더를 받아 DCInside 상세 페이지를 파싱하고 텍스트·이미지·댓글 목록을 반환.
- **`guess_extension`**: MIME 타입, 이미지 포맷, URL 접미사를 활용해 파일 확장자를 결정.
- **`download_images`**: 이미지 URL 목록을 다운로드해 저장하고, 순서/사이즈 등의 정보를 포함한 딕셔너리 리스트를 만든다.
- **`contains_video_url`**: URL 목록 중 비디오 확장자가 포함되어 있는지 판단한다.

## 외부 의존성
- `requests`: HTTP 요청 및 예외 처리.
- `BeautifulSoup4`: HTML 파싱.
- `Pillow`: 이미지 포맷 감지.

## 운영 시 유의 사항
- 이미지 저장 경로는 호출 측에서 전달한 `asset_root`를 기준으로 구성되므로, 저장소 정리가 필요하다.
- 요청 헤더에 Referer가 설정되지 않으면 일부 이미지가 차단될 수 있어 기본 헤더에 병합한다.
- 다운로드 실패 시 표준 출력에 경고를 남기고 다음 이미지로 넘어간다.
- 비디오 확장자는 상위 레이어에서 `contains_video_url`로 필터링해야 한다.
- 모바일 페이지에서 댓글을 스크래핑하므로 구조 변경 시 파싱 로직을 조정해야 한다.

## 확장 아이디어
- 이미지 크기 제한이나 파일 형식을 필터링하는 옵션 추가.
- 중복 이미지를 피하기 위해 해시 기반 캐싱 도입.
- HTML 구조 변화에 대비해 CSS 셀렉터를 설정 파일로 외부화.
